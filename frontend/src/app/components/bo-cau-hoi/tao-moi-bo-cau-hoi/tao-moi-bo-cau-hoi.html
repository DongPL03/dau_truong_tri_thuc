<div class="craft-container">

  <header class="craft-header">
    <div class="header-icon-3d">
      <i class="fas fa-magic"></i>
    </div>
    <div class="header-text">
      <h1>Chế Tác Bộ Câu Hỏi</h1>
      <p>Sáng tạo nội dung và thách thức cộng đồng!</p>
    </div>
  </header>

  <div class="craft-card">
    <form #createForm="ngForm" (ngSubmit)="onSubmit(createForm)" class="craft-form" autocomplete="off">

      <div class="form-layout">

        <section class="form-section left-col">
          <h3 class="section-title"><i class="fas fa-scroll"></i> Thông Tin Cơ Bản</h3>

          <div class="form-group">
            <label>Tiêu đề bộ câu hỏi <span class="required">*</span></label>
            <div class="input-wrapper">
              <i class="fas fa-heading input-icon"></i>
              <input type="text"
                     name="tieu_de"
                     [(ngModel)]="model.tieu_de"
                     maxlength="100"
                     placeholder="VD: Thử thách lịch sử thế giới..."
                     required>
            </div>
          </div>

          <div class="form-group">
            <label>Chủ đề kiến thức <span class="required">*</span></label>
            <div class="select-wrapper">
              <i class="fas fa-layer-group input-icon"></i>
              <select name="chu_de_id" required [(ngModel)]="model.chu_de_id">
                <option [ngValue]="0" disabled>-- Chọn chủ đề phù hợp --</option>
                @for (c of chuDes; track c.id) {
                  <option [value]="c.id">{{ c.ten }}</option>
                }
              </select>
              <i class="fas fa-chevron-down arrow-icon"></i>
            </div>
          </div>

          <div class="form-group">
            <label>Mô tả ngắn</label>
            <div class="textarea-wrapper">
              <i class="fas fa-align-left input-icon textarea-icon"></i>
              <textarea name="mo_ta"
                        rows="5"
                        maxlength="255"
                        [(ngModel)]="model.mo_ta"
                        placeholder="Giới thiệu sơ lược về bộ câu hỏi này..."></textarea>
            </div>
          </div>
        </section>

        <section class="form-section right-col">
          <h3 class="section-title"><i class="fas fa-shield-alt"></i> Quyền Truy Cập</h3>

          <div class="form-group">
            <label>Ai có thể nhìn thấy?</label>

            <div class="visibility-options">

              <label class="visual-card public-card" [class.selected]="model.che_do_hien_thi === 'PUBLIC'">
                <input type="radio" name="che_do_hien_thi" value="PUBLIC" [(ngModel)]="model.che_do_hien_thi" hidden>
                <div class="card-icon"><i class="fas fa-globe-americas"></i></div>
                <div class="card-info">
                  <span class="card-name">Công Khai</span>
                  <span class="card-desc">Mọi người đều có thể thấy và luyện tập.</span>
                </div>
                <div class="check-circle"><i class="fas fa-check"></i></div>
              </label>

              <label class="visual-card private-card" [class.selected]="model.che_do_hien_thi === 'PRIVATE'">
                <input type="radio" name="che_do_hien_thi" value="PRIVATE" [(ngModel)]="model.che_do_hien_thi" hidden>
                <div class="card-icon"><i class="fas fa-lock"></i></div>
                <div class="card-info">
                  <span class="card-name">Riêng Tư</span>
                  <span class="card-desc">Chỉ mình bạn thấy. Dùng để nháp hoặc test.</span>
                </div>
                <div class="check-circle"><i class="fas fa-check"></i></div>
              </label>

            </div>
          </div>

          @if (model.che_do_hien_thi === 'PUBLIC') {
            <div class="tip-box">
              <div class="tip-icon"><i class="fas fa-lightbulb"></i></div>
              <p><strong>Chú thích:</strong> Bộ câu hỏi công khai sẽ cần <strong>Admin duyệt</strong> trước khi xuất hiện trên
                trang chủ. Hãy đảm bảo nội dung chính xác nhé!</p>
            </div>
          }

          <div class="form-group">
            <label>Loại bộ câu hỏi</label>

            <div class="visibility-options">
              <label class="visual-card free-card" [class.selected]="!model.muon_tao_tra_phi"
                     (click)="model.muon_tao_tra_phi = false">
                <input type="radio" name="muon_tao_tra_phi" [checked]="!model.muon_tao_tra_phi" hidden>
                <div class="card-icon"><i class="fas fa-gift"></i></div>
                <div class="card-info">
                  <span class="card-name">Miễn Phí</span>
                  <span class="card-desc">Bộ câu hỏi sẽ được phát hành miễn phí cho mọi người.</span>
                </div>
                <div class="check-circle"><i class="fas fa-check"></i></div>
              </label>

              <label class="visual-card paid-card" [class.selected]="model.muon_tao_tra_phi"
                     (click)="model.muon_tao_tra_phi = true">
                <input type="radio" name="muon_tao_tra_phi" [checked]="model.muon_tao_tra_phi" hidden>
                <div class="card-icon"><i class="fas fa-coins"></i></div>
                <div class="card-info">
                  <span class="card-name">Trả Phí</span>
                  <span class="card-desc">Admin sẽ quyết định giá mở khóa khi duyệt. Bạn sẽ nhận 70% số vàng khi người chơi mở khóa.</span>
                </div>
                <div class="check-circle"><i class="fas fa-check"></i></div>
              </label>
            </div>

            @if (model.muon_tao_tra_phi) {
              <div class="tip-box info">
                <div class="tip-icon"><i class="fas fa-info-circle"></i></div>
                <p><strong>Lưu ý:</strong> Admin sẽ quyết định giá mở khóa dựa trên số lượng câu hỏi khi duyệt. Bạn sẽ
                  nhận <strong>70%</strong> số vàng mỗi khi có người chơi mở khóa bộ câu hỏi này.</p>
              </div>
            }
          </div>

        </section>
      </div>

      <div class="form-footer">
        <button type="button" class="btn-ghost" (click)="cancel()">
          <i class="fas fa-times"></i> Hủy bỏ
        </button>
        <button type="submit" class="btn-save-3d" [disabled]="creating">
          @if (creating) {
            <i class="fas fa-spinner fa-spin"></i> Đang khởi tạo...
          } @else {
            <span class="btn-content">
              <i class="fas fa-save"></i> LƯU & TIẾP TỤC
            </span>
          }
        </button>
      </div>

    </form>
  </div>
</div>
