<!--@if (!loading) {-->
<!--  <div class="profile-wrapper">-->
<!--    <div class="profile-header">-->
<!--      <h1>H·ªì s∆° ng∆∞·ªùi d√πng</h1>-->
<!--      <a routerLink="/home" class="btn-link">&larr; V·ªÅ trang ch·ªß</a>-->
<!--    </div>-->

<!--    <div class="profile-grid">-->
<!--      &lt;!&ndash; üñºÔ∏è ·∫¢nh ƒë·∫°i di·ªán &ndash;&gt;-->
<!--      <section class="card avatar-card">-->
<!--        <h3>·∫¢nh ƒë·∫°i di·ªán</h3>-->

<!--        <div class="avatar-box">-->
<!--          <img-->
<!--            [src]="avatarPreview || 'assets/images/default-profile-image.jpeg'"-->
<!--            alt="avatar"-->
<!--          />-->
<!--        </div>-->

<!--        <label class="btn btn-gray">-->
<!--          <input type="file" accept="image/*" (change)="onAvatarSelected($event)" hidden/>-->
<!--          {{ uploading ? 'ƒêang t·∫£i...' : 'Ch·ªçn ·∫£nh m·ªõi' }}-->
<!--        </label>-->
<!--        <p class="hint">ƒê·ªãnh d·∫°ng JPG/PNG, t·ªëi ƒëa 10MB</p>-->
<!--      </section>-->

<!--      &lt;!&ndash; üë§ Th√¥ng tin c√° nh√¢n &ndash;&gt;-->
<!--      <section class="card info-card">-->
<!--        <h3>Th√¥ng tin c√° nh√¢n</h3>-->

<!--        <form #infoForm="ngForm" (ngSubmit)="onSaveInfo(infoForm)">-->
<!--          <div class="form-row">-->
<!--            <label>T√™n ƒëƒÉng nh·∫≠p</label>-->
<!--            <input type="text" [value]="me?.ten_dang_nhap" disabled/>-->
<!--          </div>-->

<!--          <div class="form-row">-->
<!--            <label>Vai tr√≤</label>-->
<!--            <input type="text" [value]="me?.vai_tro?.ten_vai_tro || 'Ng∆∞·ªùi d√πng'" disabled/>-->
<!--          </div>-->

<!--          <div class="form-row">-->
<!--            <label>Email</label>-->
<!--            <input type="email" [(ngModel)]="updateDto.email" name="email" disabled/>-->
<!--          </div>-->

<!--          <div class="form-row">-->
<!--            <label>H·ªç v√† t√™n</label>-->
<!--            <input-->
<!--              type="text"-->
<!--              [(ngModel)]="updateDto.ho_ten"-->
<!--              name="ho_ten"-->
<!--              maxlength="100"-->
<!--              placeholder="VD: Nguy·ªÖn VƒÉn A"-->
<!--            />-->
<!--          </div>-->

<!--          <div class="form-row">-->
<!--            <label>T√™n hi·ªÉn th·ªã</label>-->
<!--            <input-->
<!--              type="text"-->
<!--              [(ngModel)]="updateDto.ten_hien_thi"-->
<!--              name="ten_hien_thi"-->
<!--              maxlength="100"-->
<!--              placeholder="T√™n hi·ªÉn th·ªã c√¥ng khai"-->
<!--            />-->
<!--          </div>-->

<!--          <div class="form-row">-->
<!--            <label>ƒê·ªãa ch·ªâ</label>-->
<!--            <input-->
<!--              type="text"-->
<!--              [(ngModel)]="updateDto.dia_chi"-->
<!--              name="dia_chi"-->
<!--              maxlength="255"-->
<!--              placeholder="S·ªë nh√†, ƒë∆∞·ªùng, ph∆∞·ªùng/x√£..."-->
<!--            />-->
<!--          </div>-->

<!--          <div class="action-row">-->
<!--            <button-->
<!--              class="btn btn-green"-->
<!--              type="submit"-->
<!--              [disabled]="saving || infoForm.invalid"-->
<!--            >-->
<!--              {{ saving ? 'ƒêang l∆∞u...' : 'L∆∞u thay ƒë·ªïi' }}-->
<!--            </button>-->
<!--          </div>-->
<!--        </form>-->
<!--      </section>-->

<!--      &lt;!&ndash; üîë ƒê·ªïi m·∫≠t kh·∫©u &ndash;&gt;-->
<!--      <section class="card password-card">-->
<!--        <h3>ƒê·ªïi m·∫≠t kh·∫©u</h3>-->

<!--        <form #passwordForm="ngForm" (ngSubmit)="onChangePassword(passwordForm)">-->
<!--          <div class="form-row">-->
<!--            <label>M·∫≠t kh·∫©u hi·ªán t·∫°i</label>-->
<!--            <input-->
<!--              type="password"-->
<!--              name="oldPassword"-->
<!--              [(ngModel)]="passwordModel.oldPassword"-->
<!--              required-->
<!--              placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"-->
<!--            />-->
<!--          </div>-->

<!--          <div class="form-row">-->
<!--            <label>M·∫≠t kh·∫©u m·ªõi</label>-->
<!--            <input-->
<!--              type="password"-->
<!--              name="newPassword"-->
<!--              [(ngModel)]="passwordModel.newPassword"-->
<!--              required-->
<!--              minlength="6"-->
<!--              placeholder="T·ªëi thi·ªÉu 6 k√Ω t·ª±"-->
<!--            />-->
<!--          </div>-->

<!--          <div class="form-row">-->
<!--            <label>Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi</label>-->
<!--            <input-->
<!--              type="password"-->
<!--              name="retypePassword"-->
<!--              [(ngModel)]="passwordModel.retypePassword"-->
<!--              required-->
<!--              placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi"-->
<!--            />-->
<!--          </div>-->

<!--          <div class="action-row">-->
<!--            <button-->
<!--              class="btn btn-blue"-->
<!--              type="submit"-->
<!--              [disabled]="changingPass"-->
<!--            >-->
<!--              {{ changingPass ? 'ƒêang ƒë·ªïi...' : 'ƒê·ªïi m·∫≠t kh·∫©u' }}-->
<!--            </button>-->
<!--          </div>-->
<!--        </form>-->
<!--      </section>-->
<!--    </div>-->
<!--  </div>-->
<!--} @else {-->
<!--  <div class="loading">-->
<!--    <i class="fas fa-spinner fa-spin"></i> ƒêang t·∫£i h·ªì s∆°...-->
<!--  </div>-->
<!--}-->
@if (!loading) {
  <div class="profile-wrapper">
    <header class="profile-header">
      <h1><i class="fas fa-user-circle"></i> H·ªì s∆° ng∆∞·ªùi d√πng</h1>
      <a routerLink="/home" class="btn-link">
        <i class="fas fa-home"></i> V·ªÅ trang ch·ªß
      </a>
    </header>

    <div class="profile-grid">
      <!-- üñºÔ∏è ·∫¢nh ƒë·∫°i di·ªán -->
      <section class="card avatar-card">
        <h3><i class="fas fa-camera"></i> ·∫¢nh ƒë·∫°i di·ªán</h3>

        <div class="avatar-box">
          <img
            [src]="avatarPreview || 'assets/images/default-profile-image.jpeg'"
            alt="avatar"
          />
        </div>

        <label class="btn btn-outline">
          <input
            type="file"
            accept="image/*"
            (change)="onAvatarSelected($event)"
            hidden
          />
          <i
            class="fas"
            [class.fa-spinner]="uploading"
            [class.fa-spin]="uploading"
            [class.fa-upload]="!uploading"
          ></i>
          {{ uploading ? 'ƒêang t·∫£i...' : 'Ch·ªçn ·∫£nh m·ªõi' }}
        </label>
        <p class="hint">ƒê·ªãnh d·∫°ng JPG/PNG, t·ªëi ƒëa 10MB</p>
      </section>

      <!-- üë§ Th√¥ng tin c√° nh√¢n -->
      <section class="card info-card">
        <h3><i class="fas fa-id-card"></i> Th√¥ng tin c√° nh√¢n</h3>

        <form #infoForm="ngForm" (ngSubmit)="onSaveInfo(infoForm)">
          <div class="form-grid">
            <div class="form-row">
              <label>T√™n ƒëƒÉng nh·∫≠p</label>
              <input type="text" [value]="me?.ten_dang_nhap" disabled/>
            </div>

            <div class="form-row">
              <label>Vai tr√≤</label>
              <input
                type="text"
                [value]="me?.vai_tro?.ten_vai_tro || 'Ng∆∞·ªùi d√πng'"
                disabled
              />
            </div>

            <div class="form-row">
              <label>Email</label>
              <input
                type="email"
                [(ngModel)]="updateDto.email"
                name="email"
                disabled
              />
            </div>

            <div class="form-row">
              <label>H·ªç v√† t√™n</label>
              <input
                type="text"
                [(ngModel)]="updateDto.ho_ten"
                name="ho_ten"
                maxlength="100"
                placeholder="VD: Nguy·ªÖn VƒÉn A"
              />
            </div>

            <div class="form-row">
              <label>T√™n hi·ªÉn th·ªã</label>
              <input
                type="text"
                [(ngModel)]="updateDto.ten_hien_thi"
                name="ten_hien_thi"
                maxlength="100"
                placeholder="T√™n hi·ªÉn th·ªã c√¥ng khai"
              />
            </div>

            <!--            <div class="form-row full">-->
            <!--              <label>ƒê·ªãa ch·ªâ</label>-->
            <!--              <input-->
            <!--                type="text"-->
            <!--                [(ngModel)]="updateDto.dia_chi"-->
            <!--                name="dia_chi"-->
            <!--                maxlength="255"-->
            <!--                placeholder="S·ªë nh√†, ƒë∆∞·ªùng, ph∆∞·ªùng/x√£..."-->
            <!--              />-->
            <!--            </div>-->
            <div class="form-row full">
              <label>ƒê·ªãa ch·ªâ</label>
              <app-address-selector (addressChange)="updateDto.dia_chi = $event"></app-address-selector>

              <input
                type="text"
                [(ngModel)]="updateDto.dia_chi"
                name="dia_chi"
                readonly
                placeholder="ƒê·ªãa ch·ªâ ƒë√£ ch·ªçn s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y"
              />
            </div>
          </div>

          <div class="action-row">
            <button
              class="btn btn-green"
              type="submit"
              [disabled]="saving || infoForm.invalid"
            >
              <i
                class="fas"
                [class.fa-spinner]="saving"
                [class.fa-spin]="saving"
                [class.fa-save]="!saving"
              ></i>
              {{ saving ? 'ƒêang l∆∞u...' : 'L∆∞u thay ƒë·ªïi' }}
            </button>
          </div>
        </form>
      </section>

      <!-- üîë ƒê·ªïi m·∫≠t kh·∫©u -->
      <section class="card password-card">
        <h3><i class="fas fa-lock"></i> ƒê·ªïi m·∫≠t kh·∫©u</h3>

        <form #passwordForm="ngForm" (ngSubmit)="onChangePassword(passwordForm)">
          <div class="form-row">
            <label>M·∫≠t kh·∫©u hi·ªán t·∫°i</label>
            <input
              type="password"
              name="oldPassword"
              [(ngModel)]="passwordModel.oldPassword"
              required
              placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
            />
          </div>

          <div class="form-row">
            <label>M·∫≠t kh·∫©u m·ªõi</label>
            <input
              type="password"
              name="newPassword"
              [(ngModel)]="passwordModel.newPassword"
              required
              minlength="6"
              placeholder="T·ªëi thi·ªÉu 6 k√Ω t·ª±"
            />
          </div>

          <div class="form-row">
            <label>Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi</label>
            <input
              type="password"
              name="retypePassword"
              [(ngModel)]="passwordModel.retypePassword"
              required
              placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi"
            />
          </div>

          <div class="action-row">
            <button
              class="btn btn-blue"
              type="submit"
              [disabled]="changingPass"
            >
              <i
                class="fas"
                [class.fa-spinner]="changingPass"
                [class.fa-spin]="changingPass"
                [class.fa-key]="!changingPass"
              ></i>
              {{ changingPass ? 'ƒêang ƒë·ªïi...' : 'ƒê·ªïi m·∫≠t kh·∫©u' }}
            </button>
          </div>
        </form>
      </section>
    </div>
  </div>
} @else {
  <div class="loading">
    <i class="fas fa-spinner fa-spin"></i> ƒêang t·∫£i h·ªì s∆°...
  </div>
}

